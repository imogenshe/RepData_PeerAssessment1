---
title: "Reproducible Research: Peer Assessment 1"
author: "Imogen She"
date: "11/2/2017"
output: html_document
keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading and preprocessing the data  
```{r, getting data}
library(ggplot2)
activity <- read.csv("/Users/Imo/Desktop/activity.csv", header = TRUE)
activity$date<- as.Date(activity$date) #change to the date class
```  

Get a summary of the data set.  
```{r, data summary}
head(activity)
str(activity)
summary(activity)
```  


Change the data frame to the dyplr form for easier manipulation. And plot the histogram of total number of steps taken each day.

```{r}
library(dplyr)
act <- tbl_df(activity)
group_by(act, date) %>%
        summarise(Daysum=sum(steps)) %>%
                          plot(type="h") 
```  

## What is mean total number of steps taken per day?  
Calculate the mean and median total number of steps taken per day.  
```{r}
        #sum over day

        group_by(act,date) %>%
        summarise(mean= mean(steps),median=median(steps))
act

```

## What is the average daily activity pattern?   

Plot a time series of the average number of steps taken
```{r}
a<- group_by(act,interval)
b<- summarise(a,mean=mean(steps,na.rm = T))
plot(b,ylab="Average daily steps", xlab="Interval (minutes)", type = "l")
```

Calculate the 5-minute interval that, on average, contains the maximum number of steps.  
```{r}
summary(b$mean)
filter(b, mean==max(mean))
filter(b,mean==median(mean))
```

## Imputing missing values  

To impute missing data, this report uses a for-loop function to replace the NAs with the average steps of each interval calculated previously.   
```{r}
sum(!complete.cases(act))
act_rmna<- act
for (i in 1:17568){
        if(is.na(act_rmna$steps[i]))
        {
                act_rmna$steps[i] = filter(b, b$interval==act_rmna$interval[i])[1,2]
        }
}
act_rmna$steps<-unlist(act_rmna$steps)
```

Histogram of the total number of steps taken each day after NAs imputed.  

```{r}
library(ggplot2)
a1<- group_by(act_rmna,date)
b1<- summarise(a1,mean=mean(steps,na.rm = T))
plot(b1,ylab="Average daily steps", xlab="Date", type = "h")
```  

Meand and median number of steps taken each day
sum over day
```{R}
summary(b1$mean)
filter(b1, mean==max(mean))
filter(b1,mean==median(mean))
```  

## Are there differences in activity patterns between weekdays and weekends?  

Panel plot comparing the avg. number of steps taken per 5-minute interval across weekdays and weekends.  
```{r}
#Create a new variable [week] with weekdays and weekends:
act_rmna[,4]<- weekdays(act_rmna$date)
week <- data.frame(0)
for (i in 1:17568){
        if(act_rmna$V4[i] %in% c("Saturday","Sunday"))
        {
                week[i,1]<- c("weekend")
        }
        else {week[i,1] <-c("weekday")}
}
week$X0<-factor(week$X0)

#Combine the new variable to original data frame
act_rmna$week<- week[,1]

#Calculate average steps and make plots
act1<- group_by(act_rmna, .dots=c("interval", "week"))
b2<- summarise(act1,mean=mean(steps))

p = ggplot(b2, aes(x=interval,y=mean)) +geom_line()
p + facet_grid(week ~ .)+ylab("steps")
```             








